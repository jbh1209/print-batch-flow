Schedule Board API calls
Read schedule slots

The board loads scheduled stages directly from the Supabase REST endpoint for job_stage_instances, selecting the fields needed to render each slot and filtering out rows without start/end times. Results are ordered by scheduled_start_at so the UI receives them chronologically

The UI converts these timestamps to the factory time zone (Africa/Johannesburg by default or NEXT_PUBLIC_FACTORY_TZ) before grouping them into hourly buckets (08:00‒16:00) and sorting days chronologically

Trigger server-side reschedule

The board can ask the backend to rebuild the schedule by invoking the edge function scheduler-run.

From the hook: body: { commit: true, proposed: false, onlyIfUnset: true }

From the page-level handler (used for a full rebuild): body: { commit: true, proposed: false, onlyIfUnset: false, nuclear: true, startFrom: <YYYY-MM-DD>, wipeAll: true }

Admin weekly auto-scheduling

The admin scheduler view fetches weekly slots by querying job_stage_instances within a date range (gte/lt on scheduled_start_at) and ordering by start time
It can also call the scheduler edge function per job:
body: { job_id, job_table_name: "production_jobs", trigger_reason: "manual_ui_trigger" }

Expectations for server responses
Time zone: scheduled_start_at/scheduled_end_at must be valid ISO timestamps so the client can convert them to the factory time zone.

Sorting: Results should be returned (or at least sortable) by scheduled_start_at ascending so slots appear in chronological order.

Slot granularity: Times should align with hour buckets (08:00–16:00) to match the UI’s fixed slot map.